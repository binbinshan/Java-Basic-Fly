# 现在有一个单表数据的系统，让你进行分库分表，你怎么做？

我们哗啦啦扯了一大堆分库分表的原因，现在面试官就直接给了一个开放题，让我们来设计。

主要思路有两种：
1. 停机迁移
    1. 预估迁移时间，发布公告
    2. 停止服务器
    3. 部署临时的导数工具，然后通过数据库中间件写入到不同的库和表中
    4. 修改系统的数据库连接配置
    5. 启动服务器


1. 双写不停机迁移
    * 这个是常用的迁移方式，不用停机维护，增删改操作，除了对老库增删改，都加上对新库的增删改，这就是所谓的双写。
        1. 让程序同时写入老库和数据库中间件
        2. 后台临时的程序，比较老库和数据库中间件中的数据，不存在就让中间件写入新库，存在就比较时间戳，确保新的数据覆盖旧数据。
        3. 然后就是校验新旧数据，如果不一样就从老库写入，直至相等
        4. 修改配置只写入数据库中间件